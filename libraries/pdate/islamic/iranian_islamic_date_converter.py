class IranianIslamicDateConverter:
    latest_supported_year_of_iran = 1403
    jd_support_start = 2425063  # Equivalent to CivilDate(1927, 7, 1).toJdn()
    jd_support_end = 0
    months = []
    supported_years = 0
    supported_years_start = 1346

    @staticmethod
    def initialize():
        hijri_months = [
            # 1346
            29, 30, 30, 29, 30, 30, 30, 29, 29, 30, 29, 29,
            # 1347
            30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29,
            # 1348
            29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30,
            # 1349
            29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29,
            # 1350
            30, 29, 29, 30, 30, 29, 29, 30, 29, 30, 30, 29,
            # 1351
            30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29,
            # 1352
            30, 30, 29, 30, 30, 30, 29, 29, 29, 30, 29, 30,
            # 1353
            29, 30, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29,
            # 1354
            29, 30, 30, 30, 29, 30, 30, 29, 29, 30, 29, 30,
            # 1355
            29, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29,
            # 1356
            30, 29, 29, 30, 30, 29, 30, 29, 30, 30, 29, 30,
            # 1357
            29, 30, 29, 30, 29, 30, 29, 29, 30, 30, 29, 30,
            # 1358
            30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30,
            # 1359
            30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 29, 30,
            # 1360
            30, 30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30,
            # 1361
            29, 30, 29, 30, 30, 29, 30, 30, 29, 29, 30, 29,
            # 1362
            30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 30,
            # 1363
            29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 30, 29,
            # 1364
            30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30,
            # 1365
            29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30,
            # 1366
            29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30,
            # 1367
            30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29,
            # 1368
            30, 29, 30, 30, 29, 30, 30, 29, 29, 30, 29, 30,
            # 1369
            29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 30,
            # 1370
            29, 29, 30, 29, 30, 29, 30, 29, 30, 30, 29, 30,
            # 1371
            29, 30, 29, 30, 29, 30, 29, 29, 30, 30, 30, 29,
            # 1372
            30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 30,
            # 1373
            29, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 30,
            # 1374
            29, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30,
            # 1375
            29, 30, 30, 29, 30, 30, 29, 30, 29, 29, 30, 29,
            # 1376
            30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 29, 30,
            # 1377
            29, 30, 29, 29, 30, 30, 29, 30, 30, 30, 29, 30,
            # 1378
            29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 30,
            # 1379
            30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30,
            # 1380
            30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30,
            # 1381
            30, 29, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29,
            # 1382
            30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 29, 30,
            # 1383
            29, 29, 30, 30, 29, 30, 30, 30, 29, 30, 29, 29,
            # 1384
            30, 29, 29, 30, 29, 30, 30, 30, 29, 30, 30, 29,
            # 1385
            29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 30,
            # 1386
            29, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30,
            # 1387
            29, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 30,
            # 1388
            29, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30,
            # 1389
            29, 30, 30, 29, 30, 30, 29, 30, 29, 29, 30, 29,
            # 1390
            30, 29, 30, 29, 30, 30, 30, 29, 30, 29, 30, 29,
            # 1391
            29, 30, 29, 29, 30, 30, 30, 29, 30, 30, 29, 30,
            # 1392
            29, 29, 30, 29, 29, 30, 30, 29, 30, 30, 29, 30,
            # 1393
            30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 29, 30,
            # 1394
            30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30,
            # 1395
            30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 29, 30,
            # 1396
            30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 29, 30,
            # 1397
            29, 30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 29,
            # 1398
            30, 29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30,
            # 1399
            29, 30, 29, 30, 29, 29, 30, 30, 29, 30, 30, 29,
            # 1400
            30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 30, 30,
            # 1401
            29, 30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 29,
            # 1402
            30, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30,
            # 1403
            29, 30, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29,
            # 1404
            30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 29, 30,
            # 1405
            29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30,
            # 1406
            29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30,
            # 1407
            30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 29,
            # 1408
            30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 29,
            # 1409
            30, 30, 30, 29, 29, 30, 29, 30, 29, 29, 30, 30,
            # 1410
            29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 30,
            # 1411
            30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 29,
            # 1412
            30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 30, 29,
            # 1413
            30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30,
            # 1414
            29, 30, 29, 29, 30, 29, 30, 29, 29, 30, 30, 30,
            # 1415
            30, 30, 29, 29, 29, 30, 29, 29, 29, 30, 30, 30,
            # 1416
            30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 29,
            # 1417
            30, 30, 30, 29, 29, 30, 29, 30, 29, 30, 29, 29,
            # 1418
            30, 30, 29, 30, 30, 29, 30, 29, 29, 30, 30, 29,
            # 1419
            29, 30, 29, 30, 29, 30, 30, 29, 29, 30, 30, 30,
            # 1420
            29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29,
            # 1421
            30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 30, 30,
            # 1422
            29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 30,
            # 1423
            29, 30, 30, 29, 29, 30, 29, 30, 29, 30, 29, 30,
            # 1424
            30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29,
            # 1425
            30, 29, 30, 30, 29, 30, 30, 29, 29, 30, 29, 30,
            # 1426
            29, 29, 30, 29, 30, 30, 30, 29, 30, 30, 29, 29,
            # 1427
            30, 29, 29, 30, 29, 30, 30, 30, 29, 30, 29, 30,
            # 1428
            29, 30, 29, 29, 29, 30, 30, 29, 30, 30, 30, 29,
            # 1429
            30, 29, 30, 29, 29, 29, 30, 30, 29, 30, 30, 29,
            # 1430
            30, 30, 29, 29, 30, 29, 30, 29, 29, 30, 30, 29,
            # 1431
            30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 30, 29,
            # 1432
            30, 30, 29, 30, 30, 30, 29, 30, 29, 29, 30, 29,
            # 1433
            29, 30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 30,
            # 1434
            29, 29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29,
            # 1435
            29, 30, 29, 30, 29, 30, 29, 30, 30, 30, 29, 30,
            # 1436
            29, 30, 29, 29, 30, 29, 30, 29, 30, 29, 30, 30,
            # 1437
            29, 30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 30,
            # 1438
            29, 30, 30, 30, 29, 30, 29, 29, 30, 29, 29, 30,
            # 1439
            29, 30, 30, 30, 30, 29, 30, 29, 29, 30, 29, 29,
            # 1440
            30, 29, 30, 30, 30, 29, 30, 30, 29, 29, 30, 29,
            # 1441
            29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30,
            # 1442
            29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29,
            # 1443
            29, 30, 30, 29, 29, 30, 29, 30, 30, 29, 30, 29,
            # 1444
            30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 29,
            # 1445
            30, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 29,
            # 1446 
            30, 30, 30, 29, 30, 30, 29, 30, 29, 29, 29, 30,
            # 1447
            29, 30, 30, 29, 30, 30, 30, 29, 30, 30, 29, 29
        ]

        IranianIslamicDateConverter.supported_years = len(hijri_months) // 12
        IranianIslamicDateConverter.months = [0] * len(hijri_months)
        jd = 0
        for m in range(len(hijri_months)):
            IranianIslamicDateConverter.months[m] = jd
            jd += hijri_months[m]
        IranianIslamicDateConverter.jd_support_end = jd + IranianIslamicDateConverter.jd_support_start

    @staticmethod
    def to_jdn(year: int, month: int, day: int) -> int:
        year_index = year - IranianIslamicDateConverter.supported_years_start
        if year_index < 0 or year_index >= IranianIslamicDateConverter.supported_years:
            return -1
        return (
            IranianIslamicDateConverter.months[year_index * 12 + month - 1]
            + day
            + IranianIslamicDateConverter.jd_support_start
            - 1
        )

    @staticmethod
    def from_jdn(jd: int) -> list:
        if jd < IranianIslamicDateConverter.jd_support_start or jd >= IranianIslamicDateConverter.jd_support_end:
            return None
        days = jd - IranianIslamicDateConverter.jd_support_start
        index = int(days // 29.572)
        while index + 1 < len(IranianIslamicDateConverter.months) and IranianIslamicDateConverter.months[index + 1] <= days:
            index += 1
        year_index = index // 12
        month = index % 12
        day = days - IranianIslamicDateConverter.months[index]
        return [year_index + IranianIslamicDateConverter.supported_years_start, month + 1, day + 1]


# Initialize the converter
IranianIslamicDateConverter.initialize()
